<mat-card>
  <mat-card-title>Lista de notinhas lançadas</mat-card-title>
  <mat-card-subtitle>{{ qtNotas }} Notas | Total: {{ totalNotas }}</mat-card-subtitle>
  <mat-card-content>

    <div class="filtros">
      <mat-radio-group (change)="radioChange($event)">
        <mat-radio-button value="periodo" checked >Período</mat-radio-button>
        <mat-radio-button value="lote">Lote</mat-radio-button>
      </mat-radio-group>

      <div class="filtros-campos">
        <form [formGroup]="formGroup" class="periodo">
          <mat-form-field appearance="outline" [ngClass]="{'visivel-periodo': !periodo}" >
            <mat-label>Ano</mat-label>
            <mat-select formControlName="ano">
              <mat-option value="">--Selecione--</mat-option>
              <mat-option *ngFor="let ano of anos" [value]="ano">
                {{ano}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" [ngClass]="{'visivel-periodo': !periodo}" >
            <mat-label>Mês</mat-label>
            <mat-select formControlName="mes">
              <mat-option value="">--Selecione--</mat-option>
              <mat-option *ngFor="let mes of meses" [value]="mes">
                {{mes}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" class="input-lote" [ngClass]="{'visivel-periodo': periodo}">
            <mat-label>Lote</mat-label>
            <mat-select formControlName="lote" >
              <mat-option value="">--Selecione--</mat-option>
              <mat-option *ngFor="let lote of lotes" [value]="lote.id">
                {{lote.id}} - {{ lote.data_lote | date: 'dd/MM/yyyy - EEEE'}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <button mat-raised-button (click)="getNotas()">Pesquisar</button>
        </form>

        <mat-form-field appearance="outline" class="filtro">
          <mat-label>Filtro</mat-label>
          <input matInput (keyup)="applyFilter($event)" [(ngModel)]="textFiltro" placeholder="Ex. teste" #input>
        </mat-form-field>
      </div>

    </div>

    <div class="msg" *ngIf="dataSource.data.length === 0">
      <span>Nenhuma nota lançada para o período informado.</span>
    </div>

    <div class="tabela" *ngIf="dataSource.data.length > 0">


      <table mat-table [dataSource]="dataSource" matSort (matSortChange)="announceSortChange($event)">

        <ng-container matColumnDef="loja">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> LOJA </th>
          <td mat-cell *matCellDef="let item"> {{item.loja}} </td>

        </ng-container>

        <ng-container matColumnDef="centro_de_custo">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> CENTRO DE CUSTO </th>
          <td mat-cell *matCellDef="let item"> {{item.centro_de_custo}} </td>
        </ng-container>

        <ng-container matColumnDef="despesa">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> DESPESA </th>
          <td mat-cell *matCellDef="let item"> {{item.despesa}} </td>
        </ng-container>

        <ng-container matColumnDef="codigo_despesa">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> COD. DESPESA </th>
          <td mat-cell *matCellDef="let item"> {{item.codigo_despesa}} </td>
        </ng-container>


        <ng-container matColumnDef="data_nota">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> DATA DA NOTA </th>
          <td mat-cell *matCellDef="let item"> {{item.data_nota | date: 'dd/MM/yyyy - EEEE'}} </td>
        </ng-container>

        <ng-container matColumnDef="valor_nota">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> VALOR </th>
          <td mat-cell *matCellDef="let item"> {{item.valor_nota | currency: 'BRL'}} </td>
        </ng-container>

        <ng-container matColumnDef="lote">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> LOTE </th>
          <td mat-cell *matCellDef="let item"> {{item.lote}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" [attr.colspan]="displayedColumns.length">
            Nenhuma informação encontrada para: "{{input.value}}"
          </td>
        </tr>
      </table>

    </div>

  </mat-card-content>

</mat-card>
